(function($){$(document).on('submit','.form_newsletter, .form_newsletter-sticky',function(e){e.preventDefault();var data_param=$(this).data('param');var the_form='.form_newsletter[data-param="'+data_param+'"]';$(this).addClass('active').removeClass('finished-valid finished-unvalid');$(the_form+' .submit-valid, '+the_form+' .check-valid, '+the_form+' .check-unvalid').hide();$(the_form+' .loading-valid').css('display','inline-block');jQuery.ajax({url:ajaxurl,type:$(this).attr('method'),data:$(this).serialize(),success:function(response){if(response.success){$(the_form+' .loading-valid').hide();$(the_form+' button.submit').prop('disabled',!0);$(the_form+' .check-valid').css('display','inline-block');$(the_form+'').addClass('finished-valid');$(the_form+' .cgu_newsletter').hide();$(the_form+'').css('min-height',$(the_form+'').height());$(the_form+' input, '+the_form+' button, '+the_form+' fieldset, '+the_form+' label').hide();$('.notice-newsletter-'+data_param).addClass('success').removeClass('error');if($(the_form+'').hasClass('update-sub')){var freq=$(the_form+' input[name ="frequence"').val();$('.notice-newsletter-'+data_param).html('Vous recevrez à présent notre newsletter '+freq+'.');dataLayer.push({'event':'EventGeneric','EventCat':'Formulaire','EventAction':'Fréquence','EventLibelle':'UPDATE - OK - '+freq.substr(0,1).toUpperCase()+freq.substr(1)})}else{$('.notice-newsletter-'+data_param).html(response.data);if(data_param==='home'){data_param='Middle Home'}else if(data_param==='footer'){data_param='Footer Site'}else if(data_param==='article'){data_param='Footer Article'}else if(data_param==='sidebar'){data_param='Sidebar'}else if(data_param==='footer-sticky'){data_param='Footer Sticky Mobile'}else if(data_param==='modal'){data_param='Modal'}else{data_param='Default Newsletter'}
dataLayer.push({'event':'EventGeneric','EventCat':'Formulaire','EventAction':'Inscription','EventLibelle':'NL - OK - '+data_param})}}else{$(the_form+' .loading-valid').hide();$(the_form+' .check-unvalid').css('display','inline-block');$(the_form+'').addClass('finished-unvalid');$(the_form+' .cgu_newsletter').hide();$('.notice-newsletter-'+data_param).html("Erreur : "+response.data).removeClass('success').addClass('error')}},fail:function(response){$(the_form+' .loading-valid').hide();$(the_form+' .check-unvalid').css('display','inline-block');$(the_form+'').addClass('finished-unvalid');$(the_form+' .cgu_newsletter').hide();$('.notice-newsletter-'+data_param).removeClass('success').addClass('error');$('.notice-newsletter-'+data_param).html("Il semblerait qu’une erreur interne soit survenue.<br>Notre équipe travaille actuellement sur la résolution de ce problème.<br>Merci de votre compréhension.");if($(the_form+'').hasClass('update-sub')){dataLayer.push({'event':'EventGeneric','EventCat':'Formulaire','EventAction':'Fréquence','EventLibelle':'UPDATE - KO - Quotidienne '+response.data})}else{if(data_param==='home'){data_param='Middle Home'}else if(data_param==='footer'){data_param='Footer Site'}else if(data_param==='article'){data_param='Footer Article'}else if(data_param==='sidebar'){data_param='Sidebar'}else if(data_param==='footer-sticky'){data_param='Footer Sticky Mobile'}else{data_param='Default Newsletter'}
dataLayer.push({'event':'EventGeneric','EventCat':'Formulaire','EventAction':'Inscription','EventLibelle':'NL - KO - '+data_param+' '+response.data})}}})})})(jQuery)